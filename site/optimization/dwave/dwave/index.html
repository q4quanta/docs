<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Binary Quadratic Model (BQM) - Quanta.Guru</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Binary Quadratic Model (BQM)";
    var mkdocs_page_input_path = "optimization/dwave/dwave.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Quanta.Guru</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Getting started</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/anaconda/">Guide to starting Python</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/lib/">Guide to Python Libraries</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/env/">Setting up Python Environment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/jupyter/">Installing Jupyter Notebook</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/git/">How to Git</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Quantum Gates</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../intro/qiskit/">Getting Started</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../gates/sgates/sgates/">Single Qubit Gates</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../gates/mgates/mgates/">Multiple Qubits Gates</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Quantum Circuits</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../circuits/hadamard/hadamard/">Superposition</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../circuits/bell/bell/">Bell state</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../circuits/random/random/">Random Variables</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Algorithms</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../algorithms/qft/qft/">Quantum Fourier Transform</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../algorithms/hhl/hhl/">Linear Equation (HHL)</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../algorithms/shor/shor/">Shor's Algorithm</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../algorithms/grover/grover/">Grover's Algorithm</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Optimization</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Binary Quadratic Model (BQM)
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#optimization-with-bqm">
      Optimization with BQM
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#introduction-source">Introduction source</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#example-from-constraint-satisfaction-problem-csp">Example from constraint satisfaction problem (CSP)</a>
        </li>
    
      
          

  <li class="toctree-l3">
    <a href="#quantum-implementation">
      Quantum Implementation
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#solution-steps">Solution Steps</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../routing/routing/">Vahicle Routing</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../salesman/salesman/">Travelling Salsesman</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Quantum Machine Learning</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../qml/qsvm/qsvm/">Quantum SVM</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">References</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../References/ref/">Reference</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Quanta.Guru</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Optimization &raquo;</li>
        
      
    
    <li>Binary Quadratic Model (BQM)</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="optimization-with-bqm">Optimization with BQM</h1>
<h3 id="introduction-source">Introduction <a href="https://docs.dwavesys.com/docs/latest/c_handbook_0.html">source</a></h3>
<p>Quantum computing has the potential to help solve some of the most complex technical, scientific, national defense, and commercial problems that organizations face. For quantum computing, as for classical, the first step in solving a problem is to express it in a mathematical formulation compatible with the underlying physical hardware.</p>
<p>D-Wave systems solve problems that can be mapped onto an <strong>Ising model or a quadratic unconstrained binary optimization (QUBO) problem</strong>.</p>
<p><img alt="img" src="../img/11.png" /></p>
<p>is an objective function of N binary variables represented as an upper-diagonal matrix Q, where diagonal terms are the linear coefficients and the nonzero off-diagonal terms the quadratic coefficients.</p>
<p>The mapped problem must be formulated to be compatible with the constraints of the physical system and as robust as possible to analog control errors.</p>
<h3 id="example-from-constraint-satisfaction-problem-csp">Example from constraint satisfaction problem (CSP)</h3>
<p>This example solves a map coloring problem to demonstrate an out-of-the-box use of Ocean’s <strong>classical-quantum hybrid sampler, dwave-hybrid Kerberos</strong>, that enables you to solve problems of arbitrary structure and size.</p>
<p>Map coloring is an example of a <strong><em>constraint satisfaction problem (CSP)</em></strong>. CSPs require that all a problem’s variables be assigned values, out of a finite domain, that result in the satisfying of all constraints. The map-coloring CSP is to assign a color to each region of a map such that any two regions sharing a border have different colors.</p>
<p><img alt="img" src="https://docs.ocean.dwavesys.com/en/latest/_images/us_map.png" /></p>
<p>The Map Coloring advanced example demonstrates lower-level coding of a similar problem, which gives the user more control over the solution procedure but requires the knowledge of some system parameters (e.g., knowing the maximum number of supported variables for the problem). Example Problem With Many Variables demonstrates the hybrid approach to problem solving in more detail by explicitly configuring the classical and quantum workflows.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">networkx</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">nx</span>
G <span style="color: #555555">=</span> nx<span style="color: #555555">.</span>read_adjlist(<span style="color: #CC3300">&#39;usa.adj&#39;</span>, delimiter <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;,&#39;</span>)   
</pre></div>


<hr />
<h3 id="quantum-implementation">Quantum Implementation</h3>
<h4 id="solution-steps">Solution Steps</h4>
<p>Section Solving Problems on a D-Wave System describes the process of solving problems on the quantum computer in two steps: 
  - (1) Formulate the problem as a binary quadratic model (BQM) and 
  - (2) Solve the BQM with a D-wave system or classical sampler. In this example, a function in Ocean software handles both steps. Our task is mainly to select the sampler used to solve the problem.</p>
<p>For graph <strong>G(V,E)</strong> of the map problem—no two vertices, V, connected by an edge, E, should select the same color from set <strong>C—construct</strong> a cost function with binary variables, $x_{v,c}=1$ when $v∈V$ selects color $c∈C$, by implementing two constraints:</p>
<p>$$(\sum_c x_{v,c} -1)^2$$</p>
<p>which has minimum energy (zero) when vertices select one color only, and</p>
<p>$$\sum_c \sum_{v_a,v_b \in E} x_{v_a,c} x_{v_b,c},$$</p>
<p>which adds a penalty if the vertices of an edge select the same color.</p>
<p>$$E(x_v,x_{v_a,v_b}) = \sum_v (\sum_c x_{v,c} -1)^2 +
\sum_c \sum_{v_a,v_b \in E} x_{v_a,c} x_{v_b,c}.$$</p>
<p>The minima (ground states) of this QUBO have zero energy for viable solutions. This formulation of the generic problem must still be applied to the map and color set and then embedded.</p>
<p>This section solved the map-coloring problem using a technique of formulating a problem as a constraint satisfaction problem (CSP) using penalty functions. The CSP Reformulation with Penalty Functions section describes this technique and demonstrates it in detail on a simple two-color, two-region part of this map-coloring problem in the Example of CSP reformulation with penalty functions section.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">dwave_networkx</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">dnx</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">hybrid.reference.kerberos</span> <span style="color: #006699; font-weight: bold">import</span> KerberosSampler
</pre></div>


<p>Prepare coloring scheme using D-Wave kerberoSamplers</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>coloring <span style="color: #555555">=</span> dnx<span style="color: #555555">.</span>min_vertex_coloring(G, sampler<span style="color: #555555">=</span>KerberosSampler(),\
                                   chromatic_ub<span style="color: #555555">=</span><span style="color: #FF6600">4</span>,\
                                   max_iter<span style="color: #555555">=</span><span style="color: #FF6600">10</span>,\
                                   convergence<span style="color: #555555">=</span><span style="color: #FF6600">3</span>)
<span style="color: #336666">set</span>(coloring<span style="color: #555555">.</span>values())
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>{0, 1, 2, 3}
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>

plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">12</span>,<span style="color: #FF6600">10</span>])

node_colors <span style="color: #555555">=</span> [coloring<span style="color: #555555">.</span>get(node) <span style="color: #006699; font-weight: bold">for</span> node <span style="color: #000000; font-weight: bold">in</span> G<span style="color: #555555">.</span>nodes()]

<span style="color: #0099FF; font-style: italic"># adjust the next line if using a different map</span>

<span style="color: #006699; font-weight: bold">if</span> dnx<span style="color: #555555">.</span>is_vertex_coloring(G, coloring):  
    nx<span style="color: #555555">.</span>draw(G, pos<span style="color: #555555">=</span>nx<span style="color: #555555">.</span>shell_layout(G, nlist <span style="color: #555555">=</span> [<span style="color: #336666">list</span>(G<span style="color: #555555">.</span>nodes)[x:x<span style="color: #555555">+</span><span style="color: #FF6600">10</span>] \
        <span style="color: #006699; font-weight: bold">for</span> x <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">50</span>, <span style="color: #FF6600">10</span>)] <span style="color: #555555">+</span> [[<span style="color: #336666">list</span>(G<span style="color: #555555">.</span>nodes)[<span style="color: #FF6600">50</span>]]]),\
                                         with_labels<span style="color: #555555">=</span><span style="color: #336666">True</span>, \
                                         node_color<span style="color: #555555">=</span>node_colors,\
                                          node_size<span style="color: #555555">=</span><span style="color: #FF6600">400</span>,\
                                           cmap<span style="color: #555555">=</span>plt<span style="color: #555555">.</span>cm<span style="color: #555555">.</span>rainbow)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_22_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../routing/routing/" class="btn btn-neutral float-right" title="Vahicle Routing">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../../algorithms/grover/grover/" class="btn btn-neutral" title="Grover's Algorithm"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../../algorithms/grover/grover/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../routing/routing/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
