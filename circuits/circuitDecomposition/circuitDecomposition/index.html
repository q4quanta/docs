
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Circuit Decomposition - Introductory Quantaum Computing</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#universality-circuit-decomposition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../../.." title="Introductory Quantaum Computing" class="md-header-nav__button md-logo" aria-label="Introductory Quantaum Computing">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Introductory Quantaum Computing
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Circuit Decomposition
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Introductory Quantaum Computing" class="md-nav__button md-logo" aria-label="Introductory Quantaum Computing">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Introductory Quantaum Computing
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../GettingStarted/anaconda/" class="md-nav__link">
      Guide to starting Python
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../GettingStarted/env/" class="md-nav__link">
      Setting up Python Environment
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../GettingStarted/jupyter/" class="md-nav__link">
      Installing Jupyter Notebook
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../GettingStarted/git/" class="md-nav__link">
      How to Git
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../qubit/qubit/" class="md-nav__link">
      Qubit
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gates/hgate/hgate/" class="md-nav__link">
      Hadamard Gate
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gates/ugate/ugate/" class="md-nav__link">
      Rotation Gate
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gates/pauli/pauli/" class="md-nav__link">
      Pauli Gate
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gates/rphi/rphi/" class="md-nav__link">
      R-Phi Gate
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../gates/cnot/cnot/" class="md-nav__link">
      CNOT Gate
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../One-qubit-circuit/One-qubit-circuit/" class="md-nav__link">
      One qubit Circuit
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Two-qubit-circuit/Two-qubit-circuit/" class="md-nav__link">
      Two qubit Circuit
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Three-qubit-circuit/Three-qubit-circuit/" class="md-nav__link">
      Three qubit Circuit
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Multi-qubit-circuits/Multi-qubit-circuits/" class="md-nav__link">
      Multi qubit Circuit
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../bell/bell/" class="md-nav__link">
      Bell State
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../universality/universality/" class="md-nav__link">
      Universality
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Circuit Decomposition
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Circuit Decomposition
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#universality-circuit-decomposition" class="md-nav__link">
    Universality: Circuit Decomposition
  </a>
  
    <nav class="md-nav" aria-label="Universality: Circuit Decomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#provided-unitary-matrix" class="md-nav__link">
    Provided Unitary Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trial-zero" class="md-nav__link">
    Trial Zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matrix-analysis" class="md-nav__link">
    Matrix Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagonalization-of-u" class="md-nav__link">
    Diagonalization of U
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-circuit-would-make-such-a-complicated-unitary" class="md-nav__link">
    What circuit would make such a complicated unitary?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-the-circuit" class="md-nav__link">
    Visualize the Circuit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-exact-solution" class="md-nav__link">
    More Exact Solution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../algorithms/qft/qft/" class="md-nav__link">
      Quantum Fourier Transform
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../cryptography/cryptography/" class="md-nav__link">
      Quantum Cryptography
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#universality-circuit-decomposition" class="md-nav__link">
    Universality: Circuit Decomposition
  </a>
  
    <nav class="md-nav" aria-label="Universality: Circuit Decomposition">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#provided-unitary-matrix" class="md-nav__link">
    Provided Unitary Matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trial-zero" class="md-nav__link">
    Trial Zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#matrix-analysis" class="md-nav__link">
    Matrix Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#diagonalization-of-u" class="md-nav__link">
    Diagonalization of U
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-circuit-would-make-such-a-complicated-unitary" class="md-nav__link">
    What circuit would make such a complicated unitary?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-the-circuit" class="md-nav__link">
    Visualize the Circuit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-exact-solution" class="md-nav__link">
    More Exact Solution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Circuit Decomposition</h1>
                
                <h3 id="universality-circuit-decomposition">Universality: Circuit Decomposition</h3>
<p>This notebook is from IBM Challange 2020 <a href="https://github.com/qiskit-community/may4_challenge_exercises">GitHub</a></p>
<p>Wow! If you managed to solve the first three exercises, congratulations! The fourth problem is supposed to puzzle even the quantum experts among you, so donâ€™t worry if you cannot solve it. If you can, hats off to you!</p>
<p>You may recall from your quantum mechanics course that quantum theory is unitary. Therefore, the evolution of any (closed) system can be described by a unitary. But given an arbitrary unitary, can you actually implement it on your quantum computer?</p>
<p><a href="https://qiskit.org/textbook/ch-algorithms/defining-quantum-circuits.html"><strong>"A set of quantum gates is said to be universal if any unitary transformation of the quantum data can be efficiently approximated arbitrarily well as a sequence of gates in the set."</strong></a></p>
<p>Every gate you run on the IBM Quantum Experience is transpiled into single qubit rotations and CNOT (CX) gates. We know that these constitute a universal gate set, which implies that any unitary can be implemented using only these gates. However, in general it is not easy to find a good decomposition for an arbitrary unitary. Your task is to find such a decomposition.</p>
<p>You are given the following unitary:</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">qiskit</span> <span style="color: #006699; font-weight: bold">import</span> Aer, QuantumCircuit, execute
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">qiskit.visualization</span> <span style="color: #006699; font-weight: bold">import</span> plot_histogram
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">IPython.display</span> <span style="color: #006699; font-weight: bold">import</span> display, Math, Latex
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">may4_challenge.ex1</span> <span style="color: #006699; font-weight: bold">import</span> return_state, vec_in_braket, statevec
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">may4_challenge.ex4</span> <span style="color: #006699; font-weight: bold">import</span> check_circuit, submit_circuit
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">qiskit.compiler</span> <span style="color: #006699; font-weight: bold">import</span> transpile
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
sns<span style="color: #555555">.</span>set()
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
</code></pre></div>


<h4 id="provided-unitary-matrix">Provided Unitary Matrix</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">may4_challenge.ex4</span> <span style="color: #006699; font-weight: bold">import</span> get_unitary
U <span style="color: #555555">=</span> get_unitary()
<span style="color: #0099FF; font-style: italic"># print(U)</span>
<span style="color: #336666">print</span>(<span style="color: #CC3300">&quot;U has shape&quot;</span>, U<span style="color: #555555">.</span>shape)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>U has shape (16, 16)
</code></pre></div>


<h4 id="trial-zero">Trial Zero</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>iqc <span style="color: #555555">=</span> QuantumCircuit(<span style="color: #FF6600">4</span>)
iqc<span style="color: #555555">.</span>iso(U, [<span style="color: #FF6600">0</span>,<span style="color: #FF6600">1</span>,<span style="color: #FF6600">2</span>,<span style="color: #FF6600">3</span>], [])
tiqc <span style="color: #555555">=</span> transpile(iqc, basis_gates<span style="color: #555555">=</span>[<span style="color: #CC3300">&#39;u3&#39;</span>, <span style="color: #CC3300">&#39;cx&#39;</span>],optimization_level <span style="color: #555555">=</span> <span style="color: #FF6600">2</span>)
check_circuit(tiqc)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Circuit stats:
||U-V||_2 = 4.2634217757239e-14
(U is the reference unitary, V is yours, and the global phase has been removed from both of them).
Cost is 1663

Something is not right with your circuit: the cost of the circuit is too high (above 1600)
</code></pre></div>


<h4 id="matrix-analysis">Matrix Analysis</h4>
<p>Lets visualize the Matrix
We can look at absolute values of matrix element.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">getAbs</span>(U):
    M <span style="color: #555555">=</span> np<span style="color: #555555">.</span>eye(<span style="color: #FF6600">16</span>,<span style="color: #FF6600">16</span>)
    <span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">16</span>):
        <span style="color: #006699; font-weight: bold">for</span> j <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">16</span>):
            M[i,j] <span style="color: #555555">=</span> <span style="color: #336666">abs</span>(U[i,j])
    <span style="color: #006699; font-weight: bold">return</span> M
M <span style="color: #555555">=</span> getAbs(U)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">15</span>,<span style="color: #FF6600">10</span>])
sns<span style="color: #555555">.</span>heatmap(M, annot <span style="color: #555555">=</span><span style="color: #006699; font-weight: bold">True</span>, fmt <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;0.2f&#39;</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fa416aef450&gt;
</code></pre></div>


<p><img alt="png" src="../output_8_1.png" /></p>
<h4 id="diagonalization-of-u">Diagonalization of U</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">qiskit</span> <span style="color: #006699; font-weight: bold">import</span> BasicAer
backend <span style="color: #555555">=</span> BasicAer<span style="color: #555555">.</span>get_backend(<span style="color: #CC3300">&#39;unitary_simulator&#39;</span>)
Hqc <span style="color: #555555">=</span> QuantumCircuit(<span style="color: #FF6600">4</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">0</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">1</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">2</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">3</span>)
job <span style="color: #555555">=</span> execute(Hqc, backend)
H <span style="color: #555555">=</span> job<span style="color: #555555">.</span>result()<span style="color: #555555">.</span>get_unitary(Hqc, decimals<span style="color: #555555">=</span><span style="color: #FF6600">3</span>)
H <span style="color: #555555">=</span> np<span style="color: #555555">.</span>matrix(H)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>DU <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(np<span style="color: #555555">.</span>dot(H,U),H)
ADU <span style="color: #555555">=</span> getAbs(DU)
plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">10</span>,<span style="color: #FF6600">8</span>])
sns<span style="color: #555555">.</span>heatmap(ADU, annot <span style="color: #555555">=</span><span style="color: #006699; font-weight: bold">True</span>, fmt <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;0.1f&#39;</span>)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fa416bab450&gt;
</code></pre></div>


<p><img alt="png" src="../output_11_1.png" /></p>
<h4 id="what-circuit-would-make-such-a-complicated-unitary">What circuit would make such a complicated unitary?</h4>
<p>Is there some symmetry, or is it random? We just updated Qiskit with the introduction of a <a href="https://github.com/Qiskit/qiskit-terra/tree/master/qiskit/circuit/library">quantum circuit library</a>. This library gives users access to a rich set of well-studied circuit families, instances of which can be used as benchmarks (quantum volume), as building blocks in building more complex circuits (adders), or as tools to explore quantum computational advantage over classical computation (instantaneous quantum polynomial complexity circuits).</p>
<p><strong>Using only single qubit rotations and CNOT gates, find a quantum circuit that approximates that unitary \(U \) by a unitary \(V \) up to an error \( \varepsilon = 0.01\), such that \(\lVert U - V\rVert_2 \leq \varepsilon\) !</strong> </p>
<p>Note that the norm we are using here is the spectral norm, \( \qquad \lVert A \rVert_2 = \max_{\lVert \psi \rVert_2= 1} \lVert A \psi \rVert \).</p>
<p>This can be seen as the largest scaling factor that the matrix $A$ has on any initial (normalized) state $\psi$. One can show that this norm corresponds to the largest singular value of $A$, i.e., the square root of the largest eigenvalue of the matrix $A^\dagger A$, where $A^{\dagger}$ denotes the conjugate transpose of $A$.</p>
<p><strong>When you submit a circuit, we remove the global phase of the corresponding unitary $V$ before comparing it with $U$ using the spectral norm. For example, if you submit a circuit that generates $V = \text{e}^{i\theta}U$, we remove the global phase $\text{e}^{i\theta}$ from $V$ before computing the norm, and you will have a successful submission. As a result, you do not have to worry about matching the desired unitary, $U$, up to a global phase.</strong></p>
<p>As the single-qubit gates have a much higher fidelity than the two-qubit gates, we will look at the number of CNOT-gates, \( n_{cx} \), and the number of u3-gates, \( n_{u3}\), to determine the cost of your decomposition as </p>
<p>$$
\qquad \text{cost} = 10 \cdot n_{cx} + n_{u3}
$$</p>
<p>Try to optimize the cost of your decomposition. </p>
<p><strong>Note that you will need to ensure that your circuit is composed only of \(u3\) and \(cx\) gates. The exercise is considered correctly solved if your cost is smaller than 1600.</strong></p>
<hr />
<p>For useful tips to complete this exercise as well as pointers for communicating with other participants and asking questions, please take a look at the following <a href="https://github.com/qiskit-community/may4_challenge_exercises">repository</a>. You will also find a copy of these exercises, so feel free to edit and experiment with these notebooks.</p>
<hr />
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">qiskit</span> <span style="color: #006699; font-weight: bold">import</span> BasicAer
backend <span style="color: #555555">=</span> BasicAer<span style="color: #555555">.</span>get_backend(<span style="color: #CC3300">&#39;unitary_simulator&#39;</span>)
Hqc <span style="color: #555555">=</span> QuantumCircuit(<span style="color: #FF6600">4</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">0</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">1</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">2</span>)
Hqc<span style="color: #555555">.</span>h(<span style="color: #FF6600">3</span>)
job <span style="color: #555555">=</span> execute(Hqc, backend)
H <span style="color: #555555">=</span> job<span style="color: #555555">.</span>result()<span style="color: #555555">.</span>get_unitary(Hqc, decimals<span style="color: #555555">=</span><span style="color: #FF6600">3</span>)
H <span style="color: #555555">=</span> np<span style="color: #555555">.</span>matrix(H)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>NU <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(U,H)
<span style="color: #0099FF; font-style: italic">#NU = np.dot(H,U)</span>
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic">##### build your quantum circuit here</span>
qc <span style="color: #555555">=</span> QuantumCircuit(<span style="color: #FF6600">4</span>)
qc<span style="color: #555555">.</span>h(<span style="color: #FF6600">0</span>)
qc<span style="color: #555555">.</span>h(<span style="color: #FF6600">1</span>)
qc<span style="color: #555555">.</span>h(<span style="color: #FF6600">2</span>)
qc<span style="color: #555555">.</span>h(<span style="color: #FF6600">3</span>)
qc<span style="color: #555555">.</span>iso(NU, [<span style="color: #FF6600">0</span>,<span style="color: #FF6600">1</span>,<span style="color: #FF6600">2</span>,<span style="color: #FF6600">3</span>], [])
<span style="color: #0099FF; font-style: italic">#qc.h(0)</span>
<span style="color: #0099FF; font-style: italic">#qc.h(1)</span>
<span style="color: #0099FF; font-style: italic">#qc.h(2)</span>
<span style="color: #0099FF; font-style: italic">#qc.h(3)</span>
<span style="color: #0099FF; font-style: italic">#qc.draw(output=&#39;mpl&#39;) # we draw the circuit</span>
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>&lt;qiskit.circuit.instructionset.InstructionSet at 0x7fa484630250&gt;
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic">#qc = transpile(qc, basis_gates=[&#39;u3&#39;, &#39;cx&#39;],optimization_level = 1)</span>
tqc <span style="color: #555555">=</span> transpile(qc, basis_gates<span style="color: #555555">=</span>[<span style="color: #CC3300">&#39;u3&#39;</span>, <span style="color: #CC3300">&#39;cx&#39;</span>],optimization_level <span style="color: #555555">=</span> <span style="color: #FF6600">2</span>)
<span style="color: #0099FF; font-style: italic">#qc.draw(output=&#39;mpl&#39;) # we draw the circuit</span>
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic">##### check your quantum circuit by running the next line</span>
check_circuit(tqc)
</code></pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>Circuit stats:
||U-V||_2 = 7.431794894034265e-15
(U is the reference unitary, V is yours, and the global phase has been removed from both of them).
Cost is 331

Great! Your circuit meets all the constrains.
Your score is 331. The lower, the better!
Feel free to submit your answer and remember you can re-submit a new circuit at any time!
</code></pre></div>


<p>You can check whether your circuit is valid before submitting it with <code>check_circuit(qc)</code>. Once you have a valid solution, please submit it by running the following cell (delete the <code>#</code> before <code>submit_circuit</code>). You can re-submit at any time.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code><span style="color: #0099FF; font-style: italic">#Send the circuit as the final answer, can re-submit at any time</span>
<span style="color: #0099FF; font-style: italic">#submit_circuit(tqc) </span>
</code></pre></div>


<div style="border: 2px solid black; padding: 2rem;">
    <p>
        Success ðŸŽ‰! Your circuit has been submitted. Return to the
        <a href="https://quantum-computing.ibm.com/challenges/4anniversary/?exercise=4" target="_blank">
            IBM Quantum Challenge page
        </a>
        and check your score and ranking.
    </p>
    <p>
        Remember that you can submit a circuit as many times as you
        want.
    </p>
</div>

<h4 id="visualize-the-circuit">Visualize the Circuit</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>tqc<span style="color: #555555">.</span>draw(output<span style="color: #555555">=</span><span style="color: #CC3300">&#39;mpl&#39;</span>) <span style="color: #0099FF; font-style: italic"># we draw the circuit</span>
</code></pre></div>


<p><img alt="png" src="../output_22_0.png" /></p>
<h4 id="more-exact-solution">More Exact Solution</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>qc <span style="color: #555555">=</span> QuantumCircuit(<span style="color: #FF6600">4</span>)

qc<span style="color: #555555">.</span>h(<span style="color: #336666">range</span>(<span style="color: #FF6600">4</span>))
qc<span style="color: #555555">.</span>unitary(Uprime, qc<span style="color: #555555">.</span>qubits)
qc<span style="color: #555555">.</span>h(<span style="color: #336666">range</span>(<span style="color: #FF6600">4</span>))
qc <span style="color: #555555">=</span> transpile(qc, basis_gates <span style="color: #555555">=</span> [<span style="color: #CC3300">&#39;u3&#39;</span>, <span style="color: #CC3300">&#39;cx&#39;</span>], optimization_level<span style="color: #555555">=</span><span style="color: #FF6600">3</span>)
check_circuit(qc)
qc<span style="color: #555555">.</span>draw()
<span style="color: #0099FF; font-style: italic"># apply operations to your quantum circuit here</span>
</code></pre></div>


<p>Circuit stats:
||U-V||_2 = 5.470975623515672e-15
(U is the reference unitary, V is yours, and the global phase has been removed from both of them).
Cost is 149</p>
<p>Great! Your circuit meets all the constrains.
Your score is 149. The lower, the better!
Feel free to submit your answer and remember you can re-submit a new circuit at any time!</p>
<p><img alt="final" src="../final.png" /></p>
<h4 id="references">References</h4>
<ol>
<li>https://qiskit.org/documentation/stubs/qiskit.compiler.transpile.html</li>
<li>https://qiskit.org/documentation/stubs/qiskit.circuit.QuantumCircuit.iso.html</li>
<li>https://github.com/Qiskit/qiskit-tutorials/blob/master/legacy_tutorials/terra/5_using_the_transpiler.ipynb</li>
<li>https://github.com/Qiskit/qiskit-tutorials/blob/master/tutorials/terra/advanced/4_transpiler_passes_and_passmanager.ipynb</li>
<li>https://arxiv.org/pdf/1501.06911.pdf</li>
</ol>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><code>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../universality/universality/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Universality
              </div>
            </div>
          </a>
        
        
          <a href="../../../algorithms/qft/qft/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Quantum Fourier Transform
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>